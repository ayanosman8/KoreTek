module.exports=[93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},29711,e=>{"use strict";let t=process.env.OPENROUTER_API_KEY||"";async function r(e,a={}){let{model:n="anthropic/claude-3.5-sonnet",temperature:s=.7,max_tokens:o=4096}=a,i=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json","HTTP-Referer":"http://localhost:3001","X-Title":"KoreTek Project Estimator"},body:JSON.stringify({model:n,messages:e,temperature:s,max_tokens:o})});if(!i.ok){let e=await i.text();throw Error(`OpenRouter API error: ${e}`)}let l=await i.json();return l.choices[0]?.message?.content||""}e.s(["MODELS",0,{CLAUDE_35_SONNET:"anthropic/claude-3.5-sonnet",CLAUDE_3_OPUS:"anthropic/claude-3-opus",CLAUDE_3_HAIKU:"anthropic/claude-3-haiku",GPT_4_TURBO:"openai/gpt-4-turbo",GPT_4:"openai/gpt-4",GPT_35_TURBO:"openai/gpt-3.5-turbo",GEMINI_PRO:"google/gemini-pro",LLAMA_2_70B:"meta-llama/llama-2-70b-chat"},"callOpenRouter",()=>r])},88994,e=>{"use strict";var t=e.i(37774),r=e.i(68038),a=e.i(91029),n=e.i(1175),s=e.i(38368),o=e.i(67095),i=e.i(26732),l=e.i(74159),u=e.i(43299),p=e.i(84977),d=e.i(54670),c=e.i(16684),h=e.i(80751),m=e.i(53770),f=e.i(40832),x=e.i(69611),R=e.i(93695);e.i(99490);var g=e.i(50101),w=e.i(99293),E=e.i(29711);async function v(e){try{let{projectDescription:t,originalEstimate:r,answeredQuestions:a}=await e.json();if(!t||!r||!a)return w.NextResponse.json({error:"Missing required fields"},{status:400});let n=a.filter(e=>e.answer&&"Not answered"!==e.answer).map(e=>`- ${e.question}: ${e.answer}`).join("\n"),s=`You are an expert software development consultant. You previously provided an estimate for a project and asked clarifying questions. The client has now answered those questions.

Your task is to refine the original estimate based on their answers. Focus on:
1. KEEP THE ORIGINAL PROJECT NAME - Do not change "${r.projectName}"
2. Adding or removing features based on their answers
3. Adjusting the tech stack if needed
4. Updating risks and next steps
5. Asking new, more specific questions (with options when appropriate)

IMPORTANT: For the questions array, use the same format as before:
- Simple yes/no questions as strings: "Do you need offline support?"
- Questions with specific options as objects: { "text": "Preferred platform?", "options": ["Mobile", "Web", "Both"] }
- Keep options SHORT and SIMPLE (e.g., "Mobile", "Web", "Both" not "Mobile first", "Web only")

Return a refined estimate in the same JSON format as before.`,o=`Original Project: "${t}"

Original Estimate Summary: ${r.summary}

Client's Answers to Questions:
${n||"No questions answered yet"}

Please provide a refined estimate in JSON format with this structure:
{
  "projectName": "${r.projectName}",
  "summary": "Updated 2-3 sentence summary reflecting their answers",
  "features": ["updated feature list based on their requirements"],
  "techStack": {
    "frontend": ["..."],
    "backend": ["..."],
    "database": ["..."],
    "infrastructure": ["..."]
  },
  "risks": ["updated risks"],
  "nextSteps": ["updated next steps"],
  "questions": [
    "Simple yes/no question?",
    { "text": "Question with options?", "options": ["Option 1", "Option 2", "Option 3"] }
  ]
}`,i=(await (0,E.callOpenRouter)([{role:"system",content:s},{role:"user",content:o}],{model:E.MODELS.CLAUDE_35_SONNET,temperature:.7,max_tokens:1200})).match(/\{[\s\S]*\}/);if(!i)throw Error("Failed to extract JSON from AI response");let l=JSON.parse(i[0]);return w.NextResponse.json({estimate:l})}catch(e){return console.error("Error refining estimate:",e),w.NextResponse.json({error:"Failed to refine estimate. Please try again."},{status:500})}}e.s(["POST",()=>v],82640);var y=e.i(82640);let O=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/refine-estimate/route",pathname:"/api/refine-estimate",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/estimator/app/api/refine-estimate/route.ts",nextConfigOutput:"",userland:y}),{workAsyncStorage:A,workUnitAsyncStorage:b,serverHooks:N}=O;function T(){return(0,a.patchFetch)({workAsyncStorage:A,workUnitAsyncStorage:b})}async function P(e,t,a){O.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let w="/api/refine-estimate/route";w=w.replace(/\/index$/,"")||"/";let E=await O.prepare(e,t,{srcPage:w,multiZoneDraftMode:!1});if(!E)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:v,params:y,nextConfig:A,parsedUrl:b,isDraftMode:N,prerenderManifest:T,routerServerContext:P,isOnDemandRevalidate:C,revalidateOnlyGenerated:S,resolvedPathname:_,clientReferenceManifest:k,serverActionsManifest:j}=E,q=(0,l.normalizeAppPath)(w),M=!!(T.dynamicRoutes[q]||T.routes[_]),U=async()=>((null==P?void 0:P.render404)?await P.render404(e,t,b,!1):t.end("This page could not be found"),null);if(M&&!N){let e=!!T.routes[_],t=T.dynamicRoutes[q];if(t&&!1===t.fallback&&!e){if(A.experimental.adapterPath)return await U();throw new R.NoFallbackError}}let I=null;!M||O.isDev||N||(I="/index"===(I=_)?"/":I);let D=!0===O.isDev||!M,H=M&&!D;j&&k&&(0,o.setReferenceManifestsSingleton)({page:w,clientReferenceManifest:k,serverActionsManifest:j,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:j})});let $=e.method||"GET",L=(0,s.getTracer)(),K=L.getActiveScopeSpan(),F={params:y,prerenderManifest:T,renderOpts:{experimental:{authInterrupts:!!A.experimental.authInterrupts},cacheComponents:!!A.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:A.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>O.onRequestError(e,t,a,P)},sharedContext:{buildId:v}},B=new u.NodeNextRequest(e),G=new u.NodeNextResponse(t),J=p.NextRequestAdapter.fromNodeNextRequest(B,(0,p.signalFromNodeResponse)(t));try{let o=async e=>O.handle(J,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=L.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${$} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${$} ${w}`)}),i=!!(0,n.getRequestMeta)(e,"minimalMode"),l=async n=>{var s,l;let u=async({previousCacheEntry:r})=>{try{if(!i&&C&&S&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await o(n);e.fetchMetrics=F.renderOpts.fetchMetrics;let l=F.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let u=F.renderOpts.collectedTags;if(!M)return await (0,h.sendResponse)(B,G,s,F.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[x.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=x.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,a=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=x.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:g.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await O.onRequestError(e,t,{routerKind:"App Router",routePath:w,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:C})},P),t}},p=await O.handleResponse({req:e,nextConfig:A,cacheKey:I,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:T,isRoutePPREnabled:!1,isOnDemandRevalidate:C,revalidateOnlyGenerated:S,responseGenerator:u,waitUntil:a.waitUntil,isMinimalMode:i});if(!M)return null;if((null==p||null==(s=p.value)?void 0:s.kind)!==g.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(l=p.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",C?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),N&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,m.fromNodeOutgoingHttpHeaders)(p.value.headers);return i&&M||d.delete(x.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,f.getCacheControlHeader)(p.cacheControl)),await (0,h.sendResponse)(B,G,new Response(p.value.body,{headers:d,status:p.value.status||200})),null};K?await l(K):await L.withPropagatedContext(e.headers,()=>L.trace(d.BaseServerSpan.handleRequest,{spanName:`${$} ${w}`,kind:s.SpanKind.SERVER,attributes:{"http.method":$,"http.target":e.url}},l))}catch(t){if(t instanceof R.NoFallbackError||await O.onRequestError(e,t,{routerKind:"App Router",routePath:q,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:C})}),M)throw t;return await (0,h.sendResponse)(B,G,new Response(null,{status:500})),null}}e.s(["handler",()=>P,"patchFetch",()=>T,"routeModule",()=>O,"serverHooks",()=>N,"workAsyncStorage",()=>A,"workUnitAsyncStorage",()=>b],88994)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__fdaa4668._.js.map
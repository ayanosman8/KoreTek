{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/ayanosman/dev-portfolio/estimator/lib/ai/openrouter.ts"],"sourcesContent":["/**\n * OpenRouter AI Client\n * Supports multiple models: Claude, GPT-4, Gemini, etc.\n */\n\nconst OPENROUTER_API_KEY = process.env.OPENROUTER_API_KEY || \"\";\nconst OPENROUTER_API_URL = \"https://openrouter.ai/api/v1/chat/completions\";\n\nexport interface OpenRouterMessage {\n  role: \"system\" | \"user\" | \"assistant\";\n  content: string;\n}\n\nexport interface OpenRouterOptions {\n  model?: string;\n  temperature?: number;\n  max_tokens?: number;\n}\n\n/**\n * Call OpenRouter API with any model\n */\nexport async function callOpenRouter(\n  messages: OpenRouterMessage[],\n  options: OpenRouterOptions = {}\n) {\n  const {\n    model = \"anthropic/claude-3.5-sonnet\", // Default to Claude 3.5 Sonnet\n    temperature = 0.7,\n    max_tokens = 4096,\n  } = options;\n\n  const response = await fetch(OPENROUTER_API_URL, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${OPENROUTER_API_KEY}`,\n      \"Content-Type\": \"application/json\",\n      \"HTTP-Referer\": process.env.NEXT_PUBLIC_SITE_URL || \"http://localhost:3001\",\n      \"X-Title\": \"KoreTek Project Estimator\",\n    },\n    body: JSON.stringify({\n      model,\n      messages,\n      temperature,\n      max_tokens,\n    }),\n  });\n\n  if (!response.ok) {\n    const error = await response.text();\n    throw new Error(`OpenRouter API error: ${error}`);\n  }\n\n  const data = await response.json();\n  return data.choices[0]?.message?.content || \"\";\n}\n\n/**\n * Available models on OpenRouter\n */\nexport const MODELS = {\n  // Claude models (Anthropic)\n  CLAUDE_35_SONNET: \"anthropic/claude-3.5-sonnet\",\n  CLAUDE_3_OPUS: \"anthropic/claude-3-opus\",\n  CLAUDE_3_HAIKU: \"anthropic/claude-3-haiku\",\n\n  // GPT models (OpenAI)\n  GPT_4_TURBO: \"openai/gpt-4-turbo\",\n  GPT_4: \"openai/gpt-4\",\n  GPT_35_TURBO: \"openai/gpt-3.5-turbo\",\n\n  // Google models\n  GEMINI_PRO: \"google/gemini-pro\",\n\n  // Meta models\n  LLAMA_2_70B: \"meta-llama/llama-2-70b-chat\",\n} as const;\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAED,MAAM,qBAAqB,QAAQ,GAAG,CAAC,kBAAkB,IAAI;AAC7D,MAAM,qBAAqB;AAgBpB,eAAe,eACpB,QAA6B,EAC7B,UAA6B,CAAC,CAAC;IAE/B,MAAM,EACJ,QAAQ,6BAA6B,EACrC,cAAc,GAAG,EACjB,aAAa,IAAI,EAClB,GAAG;IAEJ,MAAM,WAAW,MAAM,MAAM,oBAAoB;QAC/C,QAAQ;QACR,SAAS;YACP,eAAe,CAAC,OAAO,EAAE,oBAAoB;YAC7C,gBAAgB;YAChB,gBAAgB,6DAAoC;YACpD,WAAW;QACb;QACA,MAAM,KAAK,SAAS,CAAC;YACnB;YACA;YACA;YACA;QACF;IACF;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAQ,MAAM,SAAS,IAAI;QACjC,MAAM,IAAI,MAAM,CAAC,sBAAsB,EAAE,OAAO;IAClD;IAEA,MAAM,OAAO,MAAM,SAAS,IAAI;IAChC,OAAO,KAAK,OAAO,CAAC,EAAE,EAAE,SAAS,WAAW;AAC9C;AAKO,MAAM,SAAS;IACpB,4BAA4B;IAC5B,kBAAkB;IAClB,eAAe;IACf,gBAAgB;IAEhB,sBAAsB;IACtB,aAAa;IACb,OAAO;IACP,cAAc;IAEd,gBAAgB;IAChB,YAAY;IAEZ,cAAc;IACd,aAAa;AACf"}},
    {"offset": {"line": 99, "column": 0}, "map": {"version":3,"sources":["file:///Users/ayanosman/dev-portfolio/estimator/lib/ai/estimator.ts"],"sourcesContent":["import { callOpenRouter, MODELS } from \"./openrouter\";\nimport type { ProjectEstimate } from \"./types\";\n\n/**\n * Generate a project estimate from a user's description\n */\nexport async function generateProjectEstimate(\n  projectDescription: string,\n  userPreferences?: {\n    frontend?: string[];\n    backend?: string[];\n    database?: string[];\n    auth?: string[];\n    infrastructure?: string[];\n    payment_apis?: string[];\n    ai_apis?: string[];\n    services?: string[];\n  }\n): Promise<ProjectEstimate> {\n  // Build user preferences section if provided\n  let userPreferencesSection = '';\n  if (userPreferences && Object.values(userPreferences).some(arr => arr && arr.length > 0)) {\n    userPreferencesSection = `\\n\\nUSER'S PREFERRED TECH STACK:\nIMPORTANT: The user has specified their preferred technologies. Use these as defaults whenever appropriate:\n${userPreferences.frontend && userPreferences.frontend.length > 0 ? `- Frontend: ${userPreferences.frontend.join(', ')}` : ''}\n${userPreferences.backend && userPreferences.backend.length > 0 ? `- Backend: ${userPreferences.backend.join(', ')}` : ''}\n${userPreferences.database && userPreferences.database.length > 0 ? `- Database: ${userPreferences.database.join(', ')}` : ''}\n${userPreferences.auth && userPreferences.auth.length > 0 ? `- Auth: ${userPreferences.auth.join(', ')}` : ''}\n${userPreferences.infrastructure && userPreferences.infrastructure.length > 0 ? `- Infrastructure: ${userPreferences.infrastructure.join(', ')}` : ''}\n${userPreferences.payment_apis && userPreferences.payment_apis.length > 0 ? `- Payment APIs: ${userPreferences.payment_apis.join(', ')}` : ''}\n${userPreferences.ai_apis && userPreferences.ai_apis.length > 0 ? `- AI APIs: ${userPreferences.ai_apis.join(', ')}` : ''}\n${userPreferences.services && userPreferences.services.length > 0 ? `- Services: ${userPreferences.services.join(', ')}` : ''}\n\nUse these preferred technologies in your recommendations unless the project specifically requires different tools.\\n`;\n  }\n\n  const systemPrompt = `You are an expert software development consultant who creates feature-focused, actionable blueprints for modern applications.\n\nCRITICAL: Return ONLY valid JSON. No markdown, no code blocks, no explanatory text. Just the raw JSON object.${userPreferencesSection}\n\nIMPORTANT NAMING GUIDELINES:\n- Create a CREATIVE, BRANDABLE app name (like \"TasteTrail\", \"Snapify\", \"Chatly\")\n- NOT descriptive names (avoid \"Personal Restaurant Journal\", \"Chat Application\")\n- Think like a real app in the App Store - catchy, memorable, unique\n- Maximum 2 words, easy to say and remember\n\nSUMMARY GUIDELINES:\n- Focus on WHAT USERS CAN DO, not technical implementation\n- Highlight the core value proposition and main capabilities\n- Keep it concise (2-3 sentences max)\n- Example: \"TasteTrail lets food lovers discover, save, and share restaurant experiences. Users can log meals with photos, get AI-powered recommendations, and connect with fellow foodies.\"\n- NOT: \"A full-stack application built with Next.js that provides restaurant tracking functionality using PostgreSQL database.\"\n\nIMPORTANT: Always recommend the MOST MODERN and CUTTING-EDGE technologies available in 2025:\n\nTech Stack Preferences:\n- Frontend: Next.js 15+, React 19, TypeScript, Tailwind CSS v4\n- Backend API:\n  * Simple APIs: Next.js API Routes\n  * Type-safe APIs: tRPC (highly recommended for full-stack Next.js)\n  * High-performance/Edge: Hono (ultra-fast, edge-ready)\n  * AVOID: Express, Fastify (outdated for modern apps)\n- Database: PostgreSQL, MySQL (actual database engines - NOT services like Supabase)\n- ORM: Prisma, Drizzle ORM (database tools)\n- Auth: Clerk, Supabase Auth, Auth.js/NextAuth\n- Services: Resend (email), Stripe (payments), Uploadthing (storage)\n- Infrastructure: Vercel, Railway, Fly.io (hosting platforms)\n- Mobile: React Native with Expo, or native Swift/Kotlin\n\nBACKEND SELECTION GUIDE:\n- For simple CRUD with Next.js: Next.js API Routes\n- For type-safe full-stack: tRPC (best choice for most apps)\n- For edge/serverless performance: Hono\n- Consider suggesting multiple: [\"tRPC\", \"Hono\"] for flexibility\n\nIMPORTANT CATEGORIZATION:\n- \"frontend\": UI frameworks only (React, Next.js, TypeScript, Tailwind)\n- \"backend\": API frameworks only (Next.js API Routes, tRPC, Hono)\n- \"database\": Actual database + ORM (PostgreSQL, Prisma ORM)\n- \"auth\": Authentication services (Clerk, Supabase Auth, Auth.js)\n- \"services\": Third-party services (Resend, Stripe, Uploadthing, etc.)\n- \"infrastructure\": Hosting/deployment (Vercel, Railway, Supabase platform)\n\nYour response must be a valid JSON object with this exact structure:\n{\n  \"projectName\": \"Suggested project name\",\n  \"summary\": \"2-3 sentence FEATURE-FOCUSED summary highlighting the core capabilities users will get\",\n  \"features\": [\n    {\n      \"name\": \"Barcode Scanner Screen\",\n      \"description\": \"Scanner screen with camera access and barcode detection. Product lookup modal shows item details when barcode is scanned.\",\n      \"tier\": \"free\",\n      \"tech\": {\n        \"packages\": [\"react-camera-pro\", \"quagga2\"],\n        \"services\": [\"UPC Database API\"]\n      },\n      \"resources\": []\n    },\n    {\n      \"name\": \"Recipe Discovery Screen\",\n      \"description\": \"Recipe discovery page with ingredient matching and recipe cards. Detail modal shows cooking instructions and ingredients list.\",\n      \"tier\": \"pro\",\n      \"tech\": {\n        \"packages\": [\"openai\", \"axios\"],\n        \"services\": [\"OpenAI API\", \"Spoonacular API\"]\n      },\n      \"resources\": []\n    }\n  ],\n  \"techStack\": {\n    \"frontend\": [\"Next.js 15\", \"React 19\", \"TypeScript\", \"Tailwind CSS\"],\n    \"backend\": [\"tRPC\", \"Hono\"],\n    \"database\": [\"PostgreSQL\", \"Prisma ORM\"],\n    \"auth\": [\"Clerk\"],\n    \"payment_apis\": [\"Stripe\", \"PayPal\"],\n    \"ai_apis\": [\"OpenAI\", \"Anthropic\"],\n    \"services\": [\"Resend\", \"Uploadthing\"],\n    \"infrastructure\": [\"Vercel\"]\n  },\n  \"risks\": [\"Concise technical risk 1\", \"Concise technical risk 2\"],\n  \"nextSteps\": [\n    \"Create Next.js project with TypeScript and Tailwind CSS\",\n    \"Set up Clerk for authentication (signup/login)\",\n    \"Design database schema in Prisma (users, posts tables)\",\n    \"Deploy to Vercel and configure environment variables\",\n    \"Implement core feature components\",\n    \"Set up Stripe for payment processing\"\n  ],\n  \"questions\": [\n    \"Simple yes/no question?\",\n    { \"text\": \"Question with specific options?\", \"options\": [\"Option 1\", \"Option 2\", \"Option 3\"] }\n  ]\n}\n\nNOTE: Backend should typically include tRPC for type safety. Add Hono for edge/performance needs.\n\nIMPORTANT FEATURES STRUCTURE:\n- Generate 5-10 USER-FACING features ordered by IMPORTANCE/VALUE\n- Order features from most critical to nice-to-have:\n  1. CORE features (essential for app to function - e.g., \"Barcode Scanning\", \"Pantry Inventory View\")\n  2. ESSENTIAL features (important functionality - e.g., \"Expiration Tracking\", \"Search & Filter\")\n  3. VALUABLE features (strong utility - e.g., \"Shopping List Generation\", \"Low Stock Alerts\")\n  4. ENHANCEMENT features (nice-to-have - e.g., \"Recipe Suggestions\", \"Meal Planning\")\n  5. PREMIUM features (advanced/AI - e.g., \"Smart Recommendations\", \"Nutrition Analysis\")\n\nFEATURE NAMING:\n- Use SPECIFIC screen/view names that describe the main UI element (3-5 words)\n- Include \"Screen\", \"Dashboard\", \"View\", \"Page\" in the name to be specific\n- Examples: \"Barcode Scanner Screen\", \"Pantry Dashboard View\", \"Expiration Tracker Page\", \"Shopping List Generator\", \"Recipe Discovery Screen\"\n- Examples: \"Drink Log Screen\", \"Monthly Stats Dashboard\", \"Health Insights Page\"\n- NOT: \"Barcode Scanning\", \"Drink Logging\", \"User Authentication\"\n\nFEATURE DESCRIPTIONS:\n- Provide brief, clear implementation summary (1-2 sentences)\n- Focus on: what screens/pages are needed and key UI elements\n- Keep it simple and readable - avoid overwhelming technical details\n- Examples:\n  ✅ GOOD: \"Scanner screen with camera access and barcode detection. Product lookup modal shows item details when barcode is scanned.\"\n  ✅ GOOD: \"Inventory dashboard showing all items with search, filters, and quantity controls. Item detail view for editing.\"\n  ✅ GOOD: \"Quick-add screen with drink type selector, serving size options, and ABV calculator. Preset buttons for common drinks.\"\n\nEach feature should follow this structure:\n{\n  \"name\": \"Specific Screen/View Name (e.g., Barcode Scanner Screen, Recipe Discovery Screen, Drink Log Screen)\",\n  \"description\": \"Brief 1-2 sentence summary of what screens/pages are needed and key UI elements. Keep it simple and readable.\",\n  \"tier\": \"free\" OR \"pro\",\n  \"tech\": {\n    \"packages\": [\"Exact npm package names like '@clerk/nextjs', 'uploadthing', 'stripe'\"],\n    \"services\": [\"Third-party services like 'Clerk', 'Supabase', 'Stripe', 'Vercel'\"]\n  },\n  \"resources\": []\n}\n\nFEATURE TIER GUIDELINES:\n- \"free\": Basic functionality, essential for core experience\n- \"pro\": Advanced features, premium capabilities, heavy API usage\n\nFocus on technical depth - developers need to know EXACTLY what packages/APIs to use.\n\nIMPORTANT FOR NEXT STEPS:\nGenerate 5-8 PRACTICAL, ACTIONABLE next steps that a developer can immediately execute.\nEach step should be a concrete task, not a vague suggestion. Examples:\n- \"Set up Supabase project and configure authentication\"\n- \"Design database schema with users, posts, and comments tables\"\n- \"Install and configure Clerk for user authentication\"\n- \"Create Next.js project with TypeScript and Tailwind CSS\"\n- \"Set up Stripe account and configure payment webhooks\"\n- \"Deploy to Vercel and configure environment variables\"\n- \"Implement responsive navigation component\"\n- \"Set up tRPC router for type-safe API endpoints\"\n\nFocus on SETUP, INFRASTRUCTURE, and CORE IMPLEMENTATION tasks in a logical order.\n\nIMPORTANT FOR QUESTIONS:\n- For simple yes/no questions, use strings: \"Do you need offline support?\"\n- For questions with specific choices, use objects with options:\n  { \"text\": \"Preferred platform?\", \"options\": [\"Mobile\", \"Web\", \"Both\"] }\n- Always provide 2-4 specific options when the answer isn't a simple yes/no\n- Keep options SHORT and SIMPLE (e.g., \"Mobile\", \"Web\", \"Both\" not \"Mobile first\", \"Web only\", \"Both equally important\")\n- Options should be clear, specific, and mutually exclusive\n\nFocus on providing detailed features, modern tech stack recommendations, identifying potential risks, and practical next steps.`;\n\n  const userPrompt = `Project Description: \"${projectDescription}\"\n\nPlease analyze this project and provide a comprehensive estimate in JSON format.`;\n\n  try {\n    const response = await callOpenRouter(\n      [\n        { role: \"system\", content: systemPrompt },\n        { role: \"user\", content: userPrompt },\n      ],\n      {\n        model: MODELS.CLAUDE_35_SONNET,\n        temperature: 0.7,\n        max_tokens: 1200,\n      }\n    );\n\n    // Remove markdown code blocks if present\n    let cleanedResponse = response.trim();\n    cleanedResponse = cleanedResponse.replace(/```json\\s*/g, '').replace(/```\\s*/g, '');\n\n    // Parse JSON from response\n    const jsonMatch = cleanedResponse.match(/\\{[\\s\\S]*\\}/);\n    if (!jsonMatch) {\n      console.error(\"Failed to extract JSON. Raw response:\", response);\n      console.error(\"Cleaned response:\", cleanedResponse);\n      throw new Error(\"Failed to extract JSON from AI response\");\n    }\n\n    const estimate: ProjectEstimate = JSON.parse(jsonMatch[0]);\n    return estimate;\n  } catch (error) {\n    console.error(\"Error generating estimate:\", error);\n    throw new Error(\"Failed to generate project estimate\");\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAMO,eAAe,wBACpB,kBAA0B,EAC1B,eASC;IAED,6CAA6C;IAC7C,IAAI,yBAAyB;IAC7B,IAAI,mBAAmB,OAAO,MAAM,CAAC,iBAAiB,IAAI,CAAC,CAAA,MAAO,OAAO,IAAI,MAAM,GAAG,IAAI;QACxF,yBAAyB,CAAC;;AAE9B,EAAE,gBAAgB,QAAQ,IAAI,gBAAgB,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,EAAE,gBAAgB,QAAQ,CAAC,IAAI,CAAC,OAAO,GAAG,GAAG;AAC9H,EAAE,gBAAgB,OAAO,IAAI,gBAAgB,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,WAAW,EAAE,gBAAgB,OAAO,CAAC,IAAI,CAAC,OAAO,GAAG,GAAG;AAC1H,EAAE,gBAAgB,QAAQ,IAAI,gBAAgB,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,EAAE,gBAAgB,QAAQ,CAAC,IAAI,CAAC,OAAO,GAAG,GAAG;AAC9H,EAAE,gBAAgB,IAAI,IAAI,gBAAgB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,QAAQ,EAAE,gBAAgB,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,GAAG;AAC9G,EAAE,gBAAgB,cAAc,IAAI,gBAAgB,cAAc,CAAC,MAAM,GAAG,IAAI,CAAC,kBAAkB,EAAE,gBAAgB,cAAc,CAAC,IAAI,CAAC,OAAO,GAAG,GAAG;AACtJ,EAAE,gBAAgB,YAAY,IAAI,gBAAgB,YAAY,CAAC,MAAM,GAAG,IAAI,CAAC,gBAAgB,EAAE,gBAAgB,YAAY,CAAC,IAAI,CAAC,OAAO,GAAG,GAAG;AAC9I,EAAE,gBAAgB,OAAO,IAAI,gBAAgB,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC,WAAW,EAAE,gBAAgB,OAAO,CAAC,IAAI,CAAC,OAAO,GAAG,GAAG;AAC1H,EAAE,gBAAgB,QAAQ,IAAI,gBAAgB,QAAQ,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,EAAE,gBAAgB,QAAQ,CAAC,IAAI,CAAC,OAAO,GAAG,GAAG;;oHAEV,CAAC;IACnH;IAEA,MAAM,eAAe,CAAC;;6GAEqF,EAAE,uBAAuB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;+HAmKP,CAAC;IAE9H,MAAM,aAAa,CAAC,sBAAsB,EAAE,mBAAmB;;gFAEe,CAAC;IAE/E,IAAI;QACF,MAAM,WAAW,MAAM,IAAA,2IAAc,EACnC;YACE;gBAAE,MAAM;gBAAU,SAAS;YAAa;YACxC;gBAAE,MAAM;gBAAQ,SAAS;YAAW;SACrC,EACD;YACE,OAAO,mIAAM,CAAC,gBAAgB;YAC9B,aAAa;YACb,YAAY;QACd;QAGF,yCAAyC;QACzC,IAAI,kBAAkB,SAAS,IAAI;QACnC,kBAAkB,gBAAgB,OAAO,CAAC,eAAe,IAAI,OAAO,CAAC,WAAW;QAEhF,2BAA2B;QAC3B,MAAM,YAAY,gBAAgB,KAAK,CAAC;QACxC,IAAI,CAAC,WAAW;YACd,QAAQ,KAAK,CAAC,yCAAyC;YACvD,QAAQ,KAAK,CAAC,qBAAqB;YACnC,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,WAA4B,KAAK,KAAK,CAAC,SAAS,CAAC,EAAE;QACzD,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,MAAM,IAAI,MAAM;IAClB;AACF"}},
    {"offset": {"line": 327, "column": 0}, "map": {"version":3,"sources":["file:///Users/ayanosman/dev-portfolio/estimator/lib/auth/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\";\nimport { cookies } from \"next/headers\";\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\n\nexport async function createClient() {\n  const cookieStore = await cookies();\n\n  return createServerClient(supabaseUrl, supabaseAnonKey, {\n    cookies: {\n      getAll() {\n        return cookieStore.getAll();\n      },\n      setAll(cookiesToSet: { name: string; value: string; options?: any }[]) {\n        try {\n          cookiesToSet.forEach(({ name, value, options }) =>\n            cookieStore.set(name, value, options)\n          );\n        } catch {\n          // The `setAll` method was called from a Server Component.\n          // This can be ignored if you have middleware refreshing\n          // user sessions.\n        }\n      },\n    },\n  });\n}\n\n// Auth helpers for server-side\nexport async function getSession() {\n  const supabase = await createClient();\n  const { data } = await supabase.auth.getSession();\n  return data.session;\n}\n\nexport async function getUser() {\n  const supabase = await createClient();\n  const { data } = await supabase.auth.getUser();\n  return data.user;\n}\n\nexport async function requireAuth() {\n  const user = await getUser();\n  if (!user) {\n    throw new Error(\"Unauthorized\");\n  }\n  return user;\n}\n\nexport async function getUserProfile() {\n  const supabase = await createClient();\n  const { data: { user } } = await supabase.auth.getUser();\n\n  if (!user) return null;\n\n  const { data: profile } = await supabase\n    .from('profiles')\n    .select('*')\n    .eq('id', user.id)\n    .single();\n\n  return profile;\n}\n\nexport async function isAdmin() {\n  const profile = await getUserProfile();\n  return profile?.role === 'admin';\n}\n\nexport async function hasPaid() {\n  const profile = await getUserProfile();\n  return profile?.has_paid === true;\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AAAA;AACA;;;AAEA,MAAM;AACN,MAAM;AAEC,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,EAAC,aAAa,iBAAiB;QACtD,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAA8D;gBACnE,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,wDAAwD;gBACxD,iBAAiB;gBACnB;YACF;QACF;IACF;AACF;AAGO,eAAe;IACpB,MAAM,WAAW,MAAM;IACvB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;IAC/C,OAAO,KAAK,OAAO;AACrB;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM;IACvB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAC5C,OAAO,KAAK,IAAI;AAClB;AAEO,eAAe;IACpB,MAAM,OAAO,MAAM;IACnB,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM;IACvB,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAEtD,IAAI,CAAC,MAAM,OAAO;IAElB,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,SAC7B,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,MAAM;IAET,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,UAAU,MAAM;IACtB,OAAO,SAAS,SAAS;AAC3B;AAEO,eAAe;IACpB,MAAM,UAAU,MAAM;IACtB,OAAO,SAAS,aAAa;AAC/B"}},
    {"offset": {"line": 405, "column": 0}, "map": {"version":3,"sources":["file:///Users/ayanosman/dev-portfolio/estimator/app/api/generate-estimate/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\nimport { generateProjectEstimate } from \"@/lib/ai/estimator\";\nimport { createClient } from \"@/lib/auth/server\";\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { projectDescription } = await request.json();\n\n    if (!projectDescription || typeof projectDescription !== \"string\") {\n      return NextResponse.json(\n        { error: \"Project description is required\" },\n        { status: 400 }\n      );\n    }\n\n    if (projectDescription.length < 20) {\n      return NextResponse.json(\n        { error: \"Please provide a more detailed project description (at least 20 characters)\" },\n        { status: 400 }\n      );\n    }\n\n    // Try to get user's tech preferences if they're logged in\n    let userPreferences = undefined;\n    try {\n      const supabase = await createClient();\n      const { data: { user } } = await supabase.auth.getUser();\n\n      if (user) {\n        const { data: profile } = await supabase\n          .from('profiles')\n          .select('tech_preferences')\n          .eq('id', user.id)\n          .single();\n\n        if (profile?.tech_preferences) {\n          userPreferences = profile.tech_preferences;\n          console.log('Using user tech preferences:', userPreferences);\n        }\n      }\n    } catch (error) {\n      // If we can't get preferences, continue without them\n      console.log('No user preferences found, using defaults');\n    }\n\n    // Generate estimate using OpenRouter + Claude with user preferences\n    const estimate = await generateProjectEstimate(projectDescription, userPreferences);\n\n    return NextResponse.json({ estimate });\n  } catch (error) {\n    console.error(\"Error generating estimate:\", error);\n    return NextResponse.json(\n      { error: \"Failed to generate estimate. Please try again.\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,kBAAkB,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEjD,IAAI,CAAC,sBAAsB,OAAO,uBAAuB,UAAU;YACjE,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAkC,GAC3C;gBAAE,QAAQ;YAAI;QAElB;QAEA,IAAI,mBAAmB,MAAM,GAAG,IAAI;YAClC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA8E,GACvF;gBAAE,QAAQ;YAAI;QAElB;QAEA,0DAA0D;QAC1D,IAAI,kBAAkB;QACtB,IAAI;YACF,MAAM,WAAW,MAAM,IAAA,uIAAY;YACnC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;YAEtD,IAAI,MAAM;gBACR,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,SAC7B,IAAI,CAAC,YACL,MAAM,CAAC,oBACP,EAAE,CAAC,MAAM,KAAK,EAAE,EAChB,MAAM;gBAET,IAAI,SAAS,kBAAkB;oBAC7B,kBAAkB,QAAQ,gBAAgB;oBAC1C,QAAQ,GAAG,CAAC,gCAAgC;gBAC9C;YACF;QACF,EAAE,OAAO,OAAO;YACd,qDAAqD;YACrD,QAAQ,GAAG,CAAC;QACd;QAEA,oEAAoE;QACpE,MAAM,WAAW,MAAM,IAAA,mJAAuB,EAAC,oBAAoB;QAEnE,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAS;IACtC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAiD,GAC1D;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}